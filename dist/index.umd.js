!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.gatsbyStoryblokImage={})}(this,function(t){var e=/^(https?:)?\/\/a.storyblok.com\/f\/*[0-9]+\/*[0-9]*x*[0-9]*\/[A-Za-z0-9]+\/[\S]+\.[a-zA-Z]+/;function i(t){var i=null,a=null;if("string"==typeof t&&(i=t),"object"==typeof t&&(i=t.image,a=t.base64?t.base64:null),!(i=e.test(i)?i:null))return!1;var n=i.replace(/^(https?:)?\/\/a.storyblok.com\//,""),r=n.split("/"),o=r[4],s=r[2].split("x").map(function(t){return parseInt(t,10)}),u=s[0],h=s[1];return{originalPath:n,extension:o.split(".")[1],metadata:{dimensions:{width:u,height:h,aspectRatio:u/h},lqip:a}}}var a="https://a.storyblok.com",n=[1,1.5,2,3],r=[.25,.5,1,1.5,2,3],o={smartCrop:!0,format:null,fill:null,toFormat:null,base64:null,useBase64:!0,quality:100},s=Object.assign({},o,{maxWidth:800,maxHeight:null}),u=Object.assign({},o,{width:400,height:null});function h(t){var e=t.includes("filters:format(webp)"),i=/[a-f0-9]+-\d+x\d+\.webp/.test(t);return e||i}function l(t,e){var i=e.width,n=e.height,r=e.smartCrop,o=e.quality,s=e.format,u=e.fill,h=t.split("."),l=a;l+="/"+t+"/m",i&&n&&(l+="/"+i+"x"+n),r&&(l+="/smart");var c=[o&&"quality("+o+")",s&&s!==h[1]&&"format("+s+")",u&&"fill("+u+")"];return(c=c.filter(function(t){return!0===Boolean(t)})).length>0&&(l+=function(t){return t.reduce(function(t,e,i){return t+":"+e},"/filters")}(c)),l}function c(t,e){var i=e.height;return l(t,{width:(e.width/3).toFixed(0),height:(i/3).toFixed(0),quality:10})}t.getFixedGatsbyImage=function(t,e){void 0===e&&(e={});var a=i(t);if(!a)return null;var r=Object.assign({},u,e),o=r.width,s=r.height,f=a.metadata.dimensions,p=a.originalPath,d=f.aspectRatio;r.height&&(d=o/r.height);var b=null;r.toFormat?b=r.toFormat:h(p)&&(b="jpg");var g=n.map(function(t){return Math.round(o*t)}).filter(function(t){return t<f.width}).reduce(function(t,e,i){var a=n[i]+"x",o=Math.round(e/d),s=Object.assign({},r,{width:e,height:o}),u=l(p,Object.assign({},s,{format:"webp"})),h=l(p,Object.assign({},s,b&&{format:b}));return t.webp.push(u+" "+a),t.base.push(h+" "+a),t},{webp:[],base:[]}),m=Math.round(s||o/d),w=Object.assign({},r,{width:o,height:m}),j=l(p,Object.assign({},w,b&&{format:b})),v=l(p,Object.assign({},w,{format:"webp"}));return{base64:c(p,{width:o,height:s,aspectRatio:d}),aspectRatio:d,width:Math.round(o),height:m,src:j,srcWebp:v,srcSet:g.base.join(",\n")||null,srcSetWebp:g.webp.join(",\n")||null}},t.getFluidGatsbyImage=function(t,e){void 0===e&&(e={});var a=i(t);if(!a)return null;var n=Object.assign({},s,e),o=n.maxWidth,u=a.metadata.dimensions,f=a.originalPath,p=u.aspectRatio;n.maxHeight&&(p=o/n.maxHeight);var d=n.maxHeight||Math.round(o/u.aspectRatio),b=null;n.toFormat?b=n.toFormat:h(f)&&(b="jpg");var g=n.sizes||"(max-width: "+o+"px) 100vw, "+o+"px",m=r.map(function(t){return Math.round(o*t)}).filter(function(t){return t<u.width}).concat(u.width).filter(function(t){return t<u.width}).reduce(function(t,e){var i={width:e,height:Math.round(e/p)},a=l(f,Object.assign({},n,i,{format:"webp"})),r=l(f,Object.assign({},n,i,{format:b}));return t.webp.push(a+" "+e+"w"),t.base.push(r+" "+e+"w"),t},{webp:[],base:[]}),w={width:o,height:d},j=l(f,Object.assign({},n,w,{format:b})),v=l(f,Object.assign({},n,w,{format:"webp"}));return{base64:c(f,{width:o,height:d,aspectRatio:p}),aspectRatio:p,src:j,srcWebp:v,srcSet:m.base.join(",\n")||null,srcSetWebp:m.webp.join(",\n")||null,sizes:g}}});
//# sourceMappingURL=index.umd.js.map
